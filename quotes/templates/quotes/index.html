<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AutoQuotify - Get a Quote</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>AutoQuotify Quote Generator</h1>
    <form id="quoteForm">
        {% csrf_token %}
        <label for="service_type">Service Type:</label>
        <select id="service_type" name="service_type" required>
            <option value="electrician">Electrician</option>
            <option value="plumbing">Plumbing</option>
            <option value="graphic_design">Graphic Design</option>
            <option value="legal_consultation">Legal Consultation</option>
            <option value="carpentry">Carpentry</option>
            <option value="house_cleaning">House Cleaning</option>
        </select>
        <br><br>
        
        <label for="urgency">Urgency (0 - 3.0):</label>
        <input type="number" id="urgency" name="urgency" min="0" max="3" step="0.1" placeholder="e.g., 2.0" required><br><br>
        
        <label for="location">Location:</label>
        <input type="text" id="location" name="location" placeholder="e.g., Chennai" required><br><br>
        
        <button type="submit">Get Quote</button>
    </form>

    <div id="result"></div>

    <script>
        $(document).ready(function(){
            $("#quoteForm").on("submit", function(e){
                e.preventDefault();
                const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                let data = {
                    service_type: $("#service_type").val(),
                    urgency: parseFloat($("#urgency").val()),
                    location: $("#location").val()
                };

                $.ajax({
                    url: "/quote/",  // Adjust URL based on your URL configuration
                    type: "POST",
                    data: JSON.stringify(data),
                    contentType: "application/json",
                    headers: {"X-CSRFToken": csrftoken},
                    success: function(response){
                        $("#result").html("<h2>Quote: â‚¹" + response.price + "</h2>");
                    },
                    error: function(xhr, status, error){
                        $("#result").html("<h2>Error: " + error + "</h2>");
                    }
                });
            });
        });
    </script>
</body>
</html>
